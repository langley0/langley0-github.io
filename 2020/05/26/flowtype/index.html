<!doctype html>
<html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no"/><link rel="stylesheet" href="../../../../assets/default.css"/><link rel="stylesheet" href="../../../../assets/markdown.css"/></head><body><header class="site-header"><div class="wrapper"><nav class="site-nav"><div class="trigger"><a class="page-link" href="../../../../">blog</a><a class="page-link" href="../../../../about.html">about</a></div></nav></div></header><div class="page-content"><div class="wrapper"><div class="post"><header class="post-header"><h1 class="post-title">Flow (type checker)</h1><p></p></header><div class="articlebox"><div class="markdown-body"><p><span>react-native 로 프로젝트를 생성하면 아래와 같은 코드가 등장한다 </span></p><div style="background-color:#111;border-radius:.3em;margin:.5em 0;padding:1em;overflow:auto"><pre style="color:#ccc;background:none;font-family:Consolas, Monaco, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0;margin:0;overflow:auto"><code style="color:#ccc;background:none;font-family:Consolas, Monaco, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#cc99cd">const</span> <span class="token function-variable" style="color:#f08d49"><span class="token maybe-class-name">App</span></span><span class="token" style="color:#ccc">:</span> <span class="token" style="color:#ccc">(</span><span class="token" style="color:#ccc">)</span> <span class="token arrow" style="color:#67cdcc">=&gt;</span> <span class="token function-variable" style="color:#f08d49"><span class="token maybe-class-name">React$Node</span></span> <span class="token" style="color:#67cdcc">=</span> <span class="token" style="color:#ccc">(</span><span class="token" style="color:#ccc">)</span> <span class="token arrow" style="color:#67cdcc">=&gt;</span> <span class="token" style="color:#ccc">{</span>
  <span class="token" style="color:#cc99cd">return</span> <span class="token" style="color:#ccc">(</span><span class="token" style="color:#ccc">)</span><span class="token" style="color:#ccc">;</span>
<span class="token" style="color:#ccc">}</span><span class="token" style="color:#ccc">;</span>
</code></pre></div><p><code class="inlincode">() =&gt; React$Node</code><span> 는 타입스크립트문법과 매우 유사하다.  </span><code class="inlincode">React$Node</code><span> 라는 단어만 빼면, 아마 typescript 로 착각했을 정도이다. 도대체 이것은 무엇인지 궁금증이 생기지 않을 수 없었다. </span></p><p><span>검색을 통해 나와 비슷한 질문의 찾았다 </span></p><p><a href="https://stackoverflow.com/questions/58276469/const-app-reactnode-what-does-it-mean-this-instruction">https://stackoverflow.com/questions/58276469/const-app-reactnode-what-does-it-mean-this-instruction</a></p><blockquote><p><span>&quot;Its type definition from Flow&quot; </span></p> </blockquote><p><span>... Flow? </span></p><h2><span>Flow </span></h2><p><a href="https://flow.org">Flow</a><span> 는 자바스크립트의 스태틱타입체커이다. Facebook 에서 React 프론트엔드 개발을 돕기위해 만든 모듈이다. (참고로 typescript 는 마이크로소프트에서 만든 것이다) </span></p><h3><span>Installation </span></h3><p><span>일단 flow 를 쓰려면 babel 과 같이 사용하여야 한다. </span></p><p><span>일반 javascript 컴파일러 (nodejs, 브라우저, 등등) 들은 type annoation 을 컴파일 오류로 인식한다. 따라서 babel 로 한번 이들을 제거해줄 필요가 있다. </span></p><div style="background-color:#111;border-radius:.3em;margin:.5em 0;padding:1em;overflow:auto"><pre style="color:#ccc;background:none;font-family:Consolas, Monaco, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0;margin:0;overflow:auto"><code style="color:#ccc;background:none;font-family:Consolas, Monaco, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#f08d49">npm</span> <span class="token" style="color:#f08d49">install</span> --save-dev @babel/core @babel/cli @babel/preset-flow
</code></pre></div><p><span>인스톨이 끝난후에 .babelrc 에 preset-flow 를 추가한다. </span></p><div style="background-color:#111;border-radius:.3em;margin:.5em 0;padding:1em;overflow:auto"><pre style="color:#ccc;background:none;font-family:Consolas, Monaco, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0;margin:0;overflow:auto"><code style="color:#ccc;background:none;font-family:Consolas, Monaco, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#ccc">{</span>
  <span class="token" style="color:#f8c555">&quot;presets&quot;</span><span class="token" style="color:#67cdcc">:</span> <span class="token" style="color:#ccc">[</span><span class="token" style="color:#7ec699">&quot;@babel/preset-flow&quot;</span><span class="token" style="color:#ccc">]</span>
<span class="token" style="color:#ccc">}</span>
</code></pre></div><p><span>이후에 package.json 에 빌드프로세스를 추가한다 </span></p><div style="background-color:#111;border-radius:.3em;margin:.5em 0;padding:1em;overflow:auto"><pre style="color:#ccc;background:none;font-family:Consolas, Monaco, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0;margin:0;overflow:auto"><code style="color:#ccc;background:none;font-family:Consolas, Monaco, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">  <span class="token" style="color:#f8c555">&quot;scripts&quot;</span><span class="token" style="color:#67cdcc">:</span> <span class="token" style="color:#ccc">{</span>
    <span class="token" style="color:#f8c555">&quot;build&quot;</span><span class="token" style="color:#67cdcc">:</span> <span class="token" style="color:#7ec699">&quot;babel src/ -d lib/&quot;</span><span class="token" style="color:#ccc">,</span>
    <span class="token" style="color:#f8c555">&quot;prepublish&quot;</span><span class="token" style="color:#67cdcc">:</span> <span class="token" style="color:#7ec699">&quot;npm run build&quot;</span>
  <span class="token" style="color:#ccc">}</span>
</code></pre></div><h3><span>Usage </span></h3><p><span>Flow 는 일단 실행되면 파일들을 모니터링하고 있다가, 에러가 감지되면 출력을 하게 된다. </span></p><div style="background-color:#111;border-radius:.3em;margin:.5em 0;padding:1em;overflow:auto"><pre style="color:#ccc;background:none;font-family:Consolas, Monaco, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:0;margin:0;overflow:auto"><code style="color:#ccc;background:none;font-family:Consolas, Monaco, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">test.js:5
  5:     return x;
                ^ number. This type is incompatible with the expected return type of
  3: function foo(x: ?number): string {
                               ^^^^^^ string
</code></pre></div><p><span>일반적인 사용방법은 다음과 같다., </span></p><ul><li><code class="inlincode">flow init</code><span> 으로 프로젝트에 flow 를 초기화한다 </span></li><li><span>flow 를 실행한다 </span></li><li><code class="inlincode"> // @flow</code><span> 를 사용하면 flow 파일을 모니터링하게 된다 </span></li><li><span>코드를 작성한다 </span></li><li><span>타입체킹을 통해 에러를 확인한다 </span></li></ul><p><span>참고로 vs code 사용자는 </span><a href="https://flow.org/en/docs/editors/vscode/"><span>익스텐션 </span></a><span> 을 쓰면 된다 ( </span><s><span>그냥 vs code 써라 </span> </s><span>) </span></p><h2><em><span>Flow vs Typescript </span> </em></h2><p><span>flow 와 typescript 의 차이가 없어보인다. 둘중에 무엇인가를 선택해야한다면 그 기준이 무엇일까? </span></p><p><span>나도 flow 를 처음 접한 상황에서 정확한 판단을 내리기 힘들기 때문에, </span><a href="https://levelup.gitconnected.com/flow-vs-typescript-in-react-my-two-cents-d4d0c657d236"><span>Flow vs TypeScript in React — My two cents </span></a><span> 라는 아티클이 있어서 간단히 옮겨와본다. </span></p><p><img src="1_ulwmJZfctsdMiwO8HRFDKQ.png" alt="Static type check"/></p><p><s><span>statck type check 가 싫은 사람은 그냥 하던대로 </span> </s></p><h3><span>Flow: Pros &amp; Cons </span></h3><p><strong><span>Pros: </span> </strong></p><ul><li><strong><span>EsLint 플러그인 </span> </strong><span>: React 와 React Native 에서 모두 사용가능한 EsLint 를 제공한다 </span></li><li><strong><span>목적적합 </span> </strong><span>: typescript 의 원래 목적  </span><em><span>JS 에 스태틱타입제공 </span> </em><span> 을 완벽하게 이행할 수 있다. </span></li><li><strong><span>React 서포트 </span> </strong><span>: 일단 React 만 보면 Flow 가 Typescript 보다 타입정의가  </span><em><span>미세하게나마 </span> </em><span> 잘 되어있다. 추가로 대부분의 React 프로젝트에는 이미 Flow 가 탑재되어 있다. </span></li><li><strong><span>함수형 언어 지원 </span> </strong><span>: Typescript 는 OOP 기반으로 접근하지만, Flow 는 javascript 가 함수형언어로써 쓸수 있도록 지원해준다 </span></li><li><strong><span>쉬운 사용성 </span> </strong><span>:  </span><em><span>Babel </span> </em><span> 기반으로 통합되어 있기 때문에, 대부분의 툴체인에 잘 적용된다.  </span></li></ul><p><strong><span>Cons: </span> </strong></p><ul><li><strong><span>버전업그레이드 </span> </strong><span>: 버전이 너무 자주 바뀐다. 어쩔때는 변경된 내용이 너무 심해서 사용자를 당황스럽게 만들 때도 있다. </span></li><li><strong><span>도큐먼드 되지 않은 기능 </span> </strong><span>: 아직 모든 기능이 도큐먼드화 되지 않았다 </span></li><li><strong><span>node modules </span> </strong><span>: flow 는  </span><em><span>node_modules </span> </em><span> 폴더를 따로 구분하지 않는다. 이 안에서 에러가 발생해도 리포팅이 되는데, 이건 사용자가 수정할 수 있는 영역이 아니다(실행상 문제없는 경우에도 말이다) </span></li><li><strong><span>암시적 any 변환 </span> </strong><span>: 외부라이브러리르 import 할때 any 로 캐스팅되어서 들어오는 것을 확인하였다. 사용자가 인지를 못할 경우, 타입체크가 된 것처럼 보이기 때문에 ( </span><em><span>any 는 모든 타입에 대응 </span> </em><span>) 문제가 될 수 있다. </span></li></ul><h3><span>Typescript: Pros &amp; Cos </span></h3><p><strong><span>Pros: </span> </strong></p><ul><li><strong><span>더 큰 개발 커뮤니티 </span> </strong><span>: Flow 보다 더 오랫동안 사용되어 왔기 때문에 개발 커뮤니티가 더 크다. 당연히 타입선언도 Flow 보다 Typescript 로 된 것이 더 많다. </span></li><li><strong><span>더 빠르다 </span> </strong><span>: Flow 보다 타입체크가 더 빠르다!  </span></li><li><strong><span>선행 컴파일 </span> </strong><span>: 이건 설정으로 둘다 가능하긴 하지만, 타입체크를 별도의 프로그램없이 한다라는 것은 개발자에게 많은 이점을 가져다준다 (시간, 정신적 스트레스, 코드퀄리티 ..) </span></li></ul><p><strong><span>Cons: </span> </strong></p><ul><li><strong><span>React 서포트가 약하다 </span> </strong><span>: React 에서만큼은 Typescript 가 Flow 보다 지원이 적다. 하지만 앞으로는 나아질 수 있는 부분이다. </span></li></ul><p><span>선택은 당신의 몫! </span></p></div></div></div></div></div><footer></footer></body></html>